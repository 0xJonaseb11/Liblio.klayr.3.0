"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.convertklyToBeddows = exports.convertBeddowsTokly = void 0;
const validator_1 = require("@klayr/validator");
const FIXED_POINT = 10 ** 8;
const KLAYR_MAX_DECIMAL_POINTS = 8;
const getDecimalPlaces = (amount) => (amount.split('.')[1] || '').length;
const convertBeddowsTokly = (beddowsAmount) => {
    if (typeof beddowsAmount !== 'string') {
        throw new Error('Cannot convert non-string amount');
    }
    if (getDecimalPlaces(beddowsAmount)) {
        throw new Error('Beddows amount should not have decimal points');
    }
    const beddowsAmountBigInt = BigInt(beddowsAmount);
    if (beddowsAmountBigInt > validator_1.MAX_UINT64) {
        throw new Error('Beddows amount out of range');
    }
    const int = (beddowsAmountBigInt / BigInt(FIXED_POINT)).toString();
    const floating = Number(beddowsAmountBigInt % BigInt(FIXED_POINT)) / FIXED_POINT;
    const floatingPointsSplit = floating
        .toLocaleString('en-US', {
        maximumFractionDigits: KLAYR_MAX_DECIMAL_POINTS,
    })
        .split('.')[1];
    const res = floating !== 0 ? `${int}.${floatingPointsSplit}` : int;
    return res;
};
exports.convertBeddowsTokly = convertBeddowsTokly;
const convertklyToBeddows = (lskAmount) => {
    var _a;
    if (typeof lskAmount !== 'string') {
        throw new Error('Cannot convert non-string amount');
    }
    if (getDecimalPlaces(lskAmount) > KLAYR_MAX_DECIMAL_POINTS) {
        throw new Error('KLY amount has too many decimal points');
    }
    const splitAmount = lskAmount.split('.');
    const klayramountInt = BigInt(splitAmount[0]);
    const klayramountFloatBigInt = BigInt(((_a = splitAmount[1]) !== null && _a !== void 0 ? _a : '0').padEnd(KLAYR_MAX_DECIMAL_POINTS, '0'));
    const beddowsAmountBigInt = klayramountInt * BigInt(FIXED_POINT) + klayramountFloatBigInt;
    if (beddowsAmountBigInt > validator_1.MAX_UINT64) {
        throw new Error('KLY amount out of range');
    }
    return beddowsAmountBigInt.toString();
};
exports.convertklyToBeddows = convertklyToBeddows;
//# sourceMappingURL=format.js.map